<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/style.css">
    <title>Smart ChatBot</title>
</head>





<body>

    <div class="chat-wrapper">
        <div class="header"> 
            <img src="/static/bot.png" class="bot-logo" />
            <div class="chat-header">Smart CitChat Bot</div>
        </div>
        
        <div class="user-select-container"> 
        <label>Select User</label>
        <select id="user-select">
            <option value="Alex">Alex</option>
            <option value="Max">Max</option>
            <option value="Lily">Lily</option>
        </select>
    </div>

        <div id="chat-box" class="chat-box"></div>

        <div class="input-area">
            <input id="user-input" type="text" placeholder="Type your message.....">
            <button onclick="sendMessage()">Send</button>
        </div>
    </div>
    <script>
        function handleKey(event) {
            if (event.key == "Enter") {
                sendMessage();

            }
        }
        function sendMessage() {

            let inputField = document.getElementById("user-input");
            let message = inputField.value.trim();

            let selectedUser = document.getElementById("user-select").value;
            if (!message) return;

            let chatBox = document.getElementById("chat-box");

            chatBox.innerHTML += `<p class="message user-message"><b>${selectedUser}:</b> ${message}</p>`;

            fetch("/chat", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    user: selectedUser,
                    message: message
                })
            })
                .then(response => response.json())
                .then(data => {
                    if (data.response) {
                        chatBox.innerHTML += `<p class="message bot-message"><b>Bot:</b> ${data.response}</p>`;
                    }
                    chatBox.scrollTop = chatBox.scrollHeight;
                });
            inputField.value = "";




            /*fetch("/chat", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    message: message,
                    user: selectedUser

                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.response) {
                    chatBox.innerHTML += `<div class="message bot-message">
                        ${data.response}
                        </div>`;
                }
                chatBox.scrollTop = chatBox.scrollHeight;
            })*/

        }
    </script>
</body>

</html>